{"version":3,"sources":["components/ImageGallery/ImageGallery.module.css","components/ImageGalleryItem/ImageGalleryItem.module.css","components/Modal/Modal.module.css","components/Button/Button.module.css","components/Searchbar/Searchbar.module.css","components/Searchbar/Searchbar.js","components/ImageGalleryItem/ImageGalleryItem.js","components/Button/Button.js","apiService/apiService.js","components/Modal/Modal.js","components/ImageGallery/ImageGallery.js","App.js","index.js"],"names":["module","exports","Searchbar","onSubmit","useState","query","setQuery","handleSubmit","useCallback","e","preventDefault","trim","alert","className","s","SearchForm","type","SearchForm__button","SearchForm__button_label","SearchForm__input","placeholder","value","onChange","currentTarget","toLowerCase","ImageGalleryItem","image","onClick","src","webformatURL","alt","tags","ImageGalleryItem__image","Button","onLoadMore","data-action","axios","defaults","baseURL","params","key","image_type","orientation","per_page","api","getImg","a","page","console","log","get","q","data","hits","totalHits","modalRoot","document","querySelector","Modal","children","onToggleModal","useEffect","handleKeyDown","code","window","addEventListener","removeEventListener","createPortal","Overlay","target","ImageGallery","imageName","images","setImages","setPage","error","setError","status","setStatus","showModal","setShowModal","largeImg","setLargeImg","imagesApi","then","Promise","reject","Error","scrollTo","top","catch","response","finally","documentElement","scrollHeight","behavior","toggleModal","ImageGallery__section","map","handleClickImg","largeImageURL","id","style","color","message","length","App","setImageName","handleFormSubmit","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.ba947e1a.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"ImageGallery__section\":\"ImageGallery_ImageGallery__section__2Ki1f\",\"ImageGallery\":\"ImageGallery_ImageGallery__WSN_X\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ImageGalleryItem\":\"ImageGalleryItem_ImageGalleryItem__1VV--\",\"ImageGalleryItem__image\":\"ImageGalleryItem_ImageGalleryItem__image__1LaaR\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Overlay\":\"Modal_Overlay__1yXFv\",\"Modal\":\"Modal_Modal__2fIBu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Button\":\"Button_Button__21hcj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Searchbar\":\"Searchbar_Searchbar__3g3Wt\",\"SearchForm\":\"Searchbar_SearchForm__1LxId\",\"SearchForm__button\":\"Searchbar_SearchForm__button__2TS6V\",\"SearchForm__button_label\":\"Searchbar_SearchForm__button_label__1MHAz\",\"SearchForm--input\":\"Searchbar_SearchForm--input__2Gyxz\"};","import React, { useState, useCallback } from 'react';\r\nimport s from './Searchbar.module.css';\r\n\r\nexport default function Searchbar({ onSubmit }) {\r\n  // state = {\r\n  //   query: '',\r\n  // };\r\n\r\n  const [query, setQuery] = useState('');\r\n\r\n  const handleNameChange = e => {\r\n    setQuery(e.currentTarget.value.toLowerCase());\r\n    // this.setState({ query: e.currentTarget.value.toLowerCase() });\r\n  };\r\n\r\n  const handleSubmit = useCallback(\r\n    e => {\r\n      e.preventDefault();\r\n\r\n      if (query.trim() === '') {\r\n        alert('Пустое поле');\r\n        return;\r\n      }\r\n\r\n      onSubmit(query);\r\n      setQuery('');\r\n      // this.setState({ query: '' });\r\n    },\r\n    [query, onSubmit],\r\n  );\r\n\r\n  return (\r\n    <header className={s.Searchbar}>\r\n      <form className={s.SearchForm} onSubmit={handleSubmit}>\r\n        <button type=\"submit\" className={s.SearchForm__button}>\r\n          <span className={s.SearchForm__button_label}>Search</span>\r\n        </button>\r\n\r\n        <input\r\n          className={s.SearchForm__input}\r\n          type=\"text\"\r\n          // autocomplete=\"off\"\r\n          // autofocus\r\n          placeholder=\"Search images and photos\"\r\n          value={query}\r\n          onChange={handleNameChange}\r\n        />\r\n      </form>\r\n    </header>\r\n  );\r\n}\r\n","import s from './ImageGalleryItem.module.css';\r\nimport PropTypes from 'prop-types';\r\n\r\nexport default function ImageGalleryItem({ image, onClick }) {\r\n  return (\r\n    <li className={s.ImageGalleryItem} onClick={onClick}>\r\n      <img\r\n        src={image.webformatURL}\r\n        alt={image.tags}\r\n        className={s.ImageGalleryItem__image}\r\n      />\r\n    </li>\r\n  );\r\n}\r\n\r\nImageGalleryItem.propTypes = {\r\n  onClick: PropTypes.func,\r\n  image: PropTypes.shape({\r\n    id: PropTypes.number.isRequired,\r\n    webformatURL: PropTypes.string.isRequired,\r\n    largeImageURL: PropTypes.string.isRequired,\r\n    tags: PropTypes.string.isRequired,\r\n  }),\r\n};\r\n","import React from 'react';\r\nimport s from './Button.module.css';\r\n\r\nexport default function Button({ onLoadMore }) {\r\n  // const { onLoadMore } = this.props;\r\n\r\n  return (\r\n    <button\r\n      data-action=\"loadMore\"\r\n      type=\"button\"\r\n      className={s.Button}\r\n      onClick={onLoadMore}\r\n    >\r\n      Load more\r\n    </button>\r\n  );\r\n}\r\n","import axios from 'axios';\r\n\r\nconst API_KEY = '19136435-96f0ae3906c94a349fe1f1440';\r\nconst BASE_URL = 'https://pixabay.com/api/';\r\n\r\naxios.defaults.baseURL = BASE_URL;\r\naxios.defaults.params = {\r\n  key: API_KEY,\r\n  image_type: 'photo',\r\n  orientation: 'horizontal',\r\n  per_page: 12,\r\n};\r\n\r\nconst getImg = async (query = '', page = 1) => {\r\n  console.log(query);\r\n  console.log(page);\r\n  try {\r\n    const { data } = await axios.get('', {\r\n      params: { q: query, page },\r\n    });\r\n    return {\r\n      hits: data.hits,\r\n      totalHits: data.totalHits,\r\n    };\r\n  } catch (error) {\r\n    console.log(error);\r\n    return {\r\n      hits: [],\r\n      totalHits: 0,\r\n    };\r\n  }\r\n};\r\n\r\n// function fetchImg(query, page = 1) {\r\n\r\n//   return fetch(\r\n//     `${BASE_URL}?q=${query}&page=${page}&key=${API_KEY}&image_type=photo&orientation=horizontal&per_page=12`,\r\n//   ).then(res => {\r\n//     if (res.ok) {\r\n//       return res.json();\r\n//     }\r\n//   });\r\n// }\r\n\r\nconst api = {\r\n  getImg,\r\n};\r\n\r\nexport default api;\r\n","import React, { useEffect } from 'react';\r\nimport s from './Modal.module.css';\r\nimport { createPortal } from 'react-dom';\r\n\r\nconst modalRoot = document.querySelector('#modal-root');\r\n\r\nexport default function Modal({ children, onToggleModal }) {\r\n  // componentDidMount() {\r\n  //   window.addEventListener('keydown', this.handleKeyDown);\r\n  // }\r\n\r\n  // componentWillUnmount() {\r\n  //   window.removeEventListener('keydown', this.handleKeyDown);\r\n  // }\r\n\r\n  useEffect(() => {\r\n    const handleKeyDown = e => {\r\n      if (e.code === 'Escape') {\r\n        onToggleModal();\r\n      }\r\n    };\r\n    window.addEventListener('keydown', handleKeyDown);\r\n\r\n    return () => {\r\n      window.removeEventListener('keydown', handleKeyDown);\r\n    };\r\n  }, [onToggleModal]);\r\n\r\n  const onCloseOverlay = e => {\r\n    if (e.target === e.currentTarget) {\r\n      onToggleModal();\r\n    }\r\n  };\r\n\r\n  // const handleKeyDown = e => {\r\n  //   if (e.code === 'Escape') {\r\n  //     onToggleModal();\r\n  //   }\r\n  // };\r\n\r\n  return createPortal(\r\n    <div className={s.Overlay} onClick={onCloseOverlay}>\r\n      <div className={s.Modal}>{children}</div>\r\n    </div>,\r\n    modalRoot,\r\n  );\r\n}\r\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport s from './ImageGallery.module.css';\r\nimport ImageGalleryItem from '../ImageGalleryItem/ImageGalleryItem';\r\nimport Button from '../Button/Button';\r\nimport imagesApi from '../../apiService/apiService';\r\nimport Modal from '../Modal/Modal';\r\nimport Loader from 'react-loader-spinner';\r\n\r\nexport default function ImageGallery({ imageName }) {\r\n  const [images, setImages] = useState([]);\r\n  const [page, setPage] = useState(1);\r\n  const [error, setError] = useState(null);\r\n  const [status, setStatus] = useState('idle');\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [largeImg, setLargeImg] = useState('');\r\n\r\n  useEffect(() => {\r\n    setStatus('pending');\r\n    imagesApi\r\n      .getImg(imageName)\r\n      .then(({ hits, totalHits }) => {\r\n        console.log(hits);\r\n        if (totalHits === 0) {\r\n          return Promise.reject(\r\n            new Error(`По поиску ${imageName} ничего не найдено`),\r\n          );\r\n        }\r\n        window.scrollTo({ top: 0 });\r\n        // return () => {\r\n        setImages(hits);\r\n        setStatus('resolved');\r\n        // };\r\n      })\r\n      .catch(error => {\r\n        setError(error);\r\n        setImages([]);\r\n        setPage(1);\r\n        setStatus('rejected');\r\n      });\r\n  }, [imageName]);\r\n\r\n  useEffect(() => {\r\n    setStatus('pending');\r\n    imagesApi\r\n      .getImg(imageName, page)\r\n      .then(response => {\r\n        // return () => {\r\n        setImages([...images, ...response.hits]);\r\n        setStatus('resolved');\r\n        // };\r\n      })\r\n      .catch(error => {\r\n        setError(error);\r\n        setStatus('rejected');\r\n      })\r\n      .finally(() => {\r\n        window.scrollTo({\r\n          top: document.documentElement.scrollHeight,\r\n          behavior: 'smooth',\r\n        });\r\n      });\r\n  }, [page, imageName]);\r\n\r\n  const loadMore = () => {\r\n    // this.setState(prevState => {\r\n    //   return { page: prevState.page + 1 };\r\n    // });\r\n    setPage(page + 1);\r\n  };\r\n\r\n  // const toggleModal = () => {\r\n  //   // this.setState(({ showModal }) => ({\r\n  //   //   showModal: !showModal,\r\n  //   // }));\r\n  // }\r\n\r\n  const toggleModal = () => {\r\n    setShowModal(!showModal);\r\n  };\r\n\r\n  const handleClickImg = largeImg => {\r\n    setLargeImg(largeImg);\r\n    // this.setState({ largeImg: largeImg });\r\n    toggleModal();\r\n  };\r\n\r\n  // const { images, error, status, showModal, largeImg } = this.state;\r\n  return (\r\n    <div className={s.ImageGallery__section}>\r\n      {status === 'idle' && <p>Заполните поле</p>}\r\n      <ul className={s.ImageGallery}>\r\n        {images &&\r\n          images.map(image => (\r\n            <ImageGalleryItem\r\n              key={image.id}\r\n              image={image}\r\n              onClick={() => {\r\n                handleClickImg(image.largeImageURL);\r\n              }}\r\n            />\r\n          ))}\r\n      </ul>\r\n      {status === 'rejected' && (\r\n        <h1 style={{ color: 'red' }}>{error.message}</h1>\r\n      )}\r\n      {status === 'pending' && <Loader type=\"TailSpin\" color=\"#00BFFF\" />}\r\n      {(images.length > 0 || status === 'resolved') && (\r\n        <Button onLoadMore={loadMore} />\r\n      )}\r\n      {showModal && (\r\n        <Modal onToggleModal={toggleModal}>\r\n          <img src={largeImg} alt={images.tags} />\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// componentDidUpdate(prevProps, prevState) {\r\n//   const prevName = prevProps.imageName;\r\n//   const nextName = this.props.imageName;\r\n//   const prevPage = prevState.page;\r\n//   const nextPage = this.state.page;\r\n\r\n//   if (prevName !== nextName) {\r\n//     this.setState({ status: 'pending' });\r\n\r\n//     imagesApi\r\n//       .getImg(nextName)\r\n//       .then(({ hits, totalHits }) => {\r\n//         if (totalHits === 0) {\r\n//           return Promise.reject(\r\n//             new Error(`По поиску ${nextName} ничего не найдено`),\r\n//           );\r\n//         }\r\n//         window.scrollTo({ top: 0 });\r\n//         return this.setState({\r\n//           images: [...hits],\r\n//           status: 'resolved',\r\n//         });\r\n//       })\r\n//       .catch(error =>\r\n//         this.setState({ error, images: [], page: 1, status: 'rejected' }),\r\n//       );\r\n//   }\r\n\r\n//   if (prevPage !== nextPage && nextPage !== 1) {\r\n//     this.setState({ status: 'pending' });\r\n\r\n//     imagesApi\r\n//       .getImg(nextName, nextPage)\r\n//       .then(images => {\r\n//         return this.setState(prevState => ({\r\n//           images: [...prevState.images, ...images.hits],\r\n//           status: 'resolved',\r\n//         }));\r\n//       })\r\n//       .catch(error => this.setState({ error, status: 'rejected' }))\r\n//       .finally(res => {\r\n//         window.scrollTo({\r\n//           top: document.documentElement.scrollHeight,\r\n//           behavior: 'smooth',\r\n//         });\r\n//       });\r\n//   }\r\n// }\r\n","import React, { useState, useCallback } from 'react';\nimport Searchbar from './components/Searchbar/Searchbar';\nimport ImageGallery from './components/ImageGallery';\n\nexport default function App() {\n  // state = {\n  //   imageName: '',\n  // };\n  const [imageName, setImageName] = useState('');\n\n  const handleFormSubmit = useCallback(imageName => {\n    setImageName(imageName);\n    // this.setState({ imageName });\n  }, []);\n\n  return (\n    <>\n      <Searchbar onSubmit={handleFormSubmit} />\n      <ImageGallery imageName={imageName} />\n    </>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}